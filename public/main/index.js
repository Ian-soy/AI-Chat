"use strict";const e=require("electron"),a=require("path");function r(n){const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const o in n)if(o!=="default"){const s=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(i,o,s.get?s:{enumerable:!0,get:()=>n[o]})}}return i.default=n,Object.freeze(i)}const t=r(a),l=e.app.isPackaged?"production":"development",d={winURL:{development:"http://localhost:5173",production:`${a.join("dist","index.html")}`},loadingURL:{development:"http://localhost:5173/loader.html",production:`file://${a.join(e.app.getAppPath(),"dist","loader.html")}`}},c=d.winURL[l],p=d.loadingURL[l],w=e.nativeImage.createFromPath(t.join(__dirname,"..","logo.png"));class h{winURL="";shartURL="";loadWindow=null;mainWindow=null;constructor(){this.winURL=c,this.shartURL=p}createMainWindow(){this.mainWindow=new e.BrowserWindow({width:900,height:650,icon:t.join(__dirname,"..","logo.png"),titleBarStyle:"hidden",frame:!1,show:!1,center:!0,webPreferences:{preload:t.join(__dirname,"..","preload/index.js"),contextIsolation:!0,devTools:!e.app.isPackaged}}),e.app.isPackaged?this.mainWindow.loadFile(this.winURL):this.mainWindow.loadURL(process.env.VITE_DEV_SERVER_URL),this.mainWindow.once("ready-to-show",()=>{this.loadWindow&&this.loadWindow.destroy(),this.mainWindow?.show()}),this.mainWindow.on("closed",()=>{this.mainWindow=null});const i=new e.Tray(w),o=e.Menu.buildFromTemplate([{label:"显示",click:()=>this.mainWindow?.show()},{label:"退出",role:"quit"}]);i.setToolTip("Space Helper"),i.setContextMenu(o),e.ipcMain.on("window-minimize",()=>this.mainWindow?.minimize()),e.ipcMain.on("window-toggle-maximize",()=>{this.mainWindow?.isMaximized()?this.mainWindow?.unmaximize():this.mainWindow?.maximize()}),e.ipcMain.on("window-close",()=>this.mainWindow?.close())}loadingWindow(i){this.loadWindow=new e.BrowserWindow({width:400,height:600,frame:!1,skipTaskbar:!0,transparent:!0,resizable:!1,show:!1,webPreferences:{experimentalFeatures:!0,preload:t.join(__dirname,"..","preload/index.js"),devTools:!e.app.isPackaged}}),this.loadWindow.loadURL(i),this.loadWindow.show(),this.loadWindow.setAlwaysOnTop(!0),setTimeout(()=>{this.createMainWindow()},2e3)}initWindow(){return this.loadingWindow(this.shartURL)}}e.app.whenReady().then(()=>{new h().initWindow()});e.app.commandLine.appendSwitch("disable-features","OutOfBlinkCors");e.app.on("window-all-closed",()=>{e.app.quit()});e.app.on("browser-window-created",()=>{console.log("window-created")});process.defaultApp?process.argv.length>=2&&(e.app.removeAsDefaultProtocolClient("Space Helper"),console.log("connot work")):e.app.setAsDefaultProtocolClient("Space Helper");
